# Release Notes: v0.3.1

**Status:** Development **Release Date:** TBD

## Overview

v0.3.1 adds critical development infrastructure improvements: automated license compliance checking
and TypeScript type checking. These features ensure code quality and legal safety before every
commit and push.

## What's New

### License Compliance Checking

Automated detection and blocking of restrictive licenses (GPL, LGPL, AGPL, SSPL, etc.):

- **`scripts/check-licenses.js`** - Platform-independent Node.js checker
- **Blocks copyleft licenses**: GPL, LGPL, AGPL, SSPL, EUPL, OSL, CDDL, EPL
- **Allows permissive licenses**: MIT, ISC, Apache-2.0, BSD variants, CC0, Unlicense
- **Smart handling**: Supports OR/AND license combinations
- **Clear output**: Colored terminal output with actionable error messages
- **npm script**: `npm run license:check`
- **Automated enforcement**: Integrated into pre-push git hook

**Why this matters:** Prevents accidental inclusion of copyleft dependencies that would force the
entire project to adopt GPL/LGPL licensing. Critical for commercial use and redistribution.

### TypeScript Type Checking

Automated type safety validation:

- **npm script**: `npm run typecheck` (runs `tsc --noEmit`)
- **Makefile target**: `make typecheck`
- **Integrated into**:
  - `make quality` - Full quality check suite
  - Pre-commit hook - Fast feedback on type errors
- **Zero runtime overhead**: Type checking only, no compilation

### Enhanced Git Hooks

**Pre-commit hook** (fast, ~2-5 seconds):

1. Auto-format code (Biome + Prettier + rustfmt)
2. Verify formatting
3. Lint (Biome)
4. **Type check** ← NEW
5. Rust checks (fmt + clippy)

**Pre-push hook** (comprehensive, ~10-30 seconds):

1. Version sync check
2. **License compliance** ← NEW
3. Full quality checks
4. Build verification (WASM + TypeScript)
5. Full test suite (115 tests)
6. Optional fixture validation

### Developer Dependencies

- **husky@^9.1.7** - Git hooks management
- **license-checker@^25.0.1** - License compliance scanning

## Breaking Changes

None. This is a development infrastructure release with no API changes.

## Migration from v0.3.0

No code changes required. Install dependencies and hooks will activate:

```bash
npm install
```

The `prepare` script will automatically initialize husky hooks.

## Developer Experience

### Benefits

- **Catch issues earlier**: Type errors and lint issues caught at commit time
- **Legal safety**: GPL/LGPL dependencies blocked automatically
- **Consistent quality**: All contributors get same quality checks
- **Fast feedback**: Pre-commit checks complete in 2-5 seconds
- **Comprehensive validation**: Pre-push ensures everything works before pushing

### Manual Checks

All checks can be run manually:

```bash
npm run typecheck           # Type check only
npm run license:check       # License compliance only
make typecheck             # Same via Makefile
make quality               # All checks (format, lint, typecheck, rust)
```

## Technical Details

### License Checker Implementation

- **Language**: Pure Node.js (no runtime dependencies beyond license-checker)
- **Scope**: Production dependencies only (devDependencies allowed to have any license)
- **Output**: Colored terminal output with summary statistics
- **Exit codes**: 0 = pass, 1 = fail (CI-friendly)
- **Performance**: < 1 second for typical dependency trees

### Type Checking Integration

- **Tool**: Native TypeScript compiler (`tsc`)
- **Mode**: `--noEmit` (validation only, no output files)
- **Configuration**: Uses project's `tsconfig.json`
- **Performance**: ~1-2 seconds for full codebase

## Documentation

- **Development Guide**: Updated hook documentation
- **Makefile**: Added `make typecheck` target
- **package.json**: Added `typecheck` and `license:check` scripts

## Known Limitations

1. **License checker accuracy**: Relies on package.json license fields being accurate
2. **No runtime license validation**: Only checks at development time
3. **Manual hook bypass**: Developers can use `--no-verify` to skip hooks (discouraged)

## Rationale

### Why License Checking?

1. **Legal protection**: Prevents accidental GPL contamination
2. **Commercial safety**: Ensures project remains MIT-licensed and redistributable
3. **Automated enforcement**: No manual review needed
4. **Early detection**: Catches issues before they reach production

### Why Type Checking in Pre-commit?

1. **Fast feedback**: Developers learn about type errors immediately
2. **Reduced CI load**: Catches errors before push
3. **Better commits**: Ensures every commit is type-safe
4. **IDE independence**: Works even if IDE type checking is disabled

## Future Enhancements

Potential improvements for future releases:

- **License report generation**: JSON output for compliance documentation
- **Custom license rules**: Project-specific allowed/blocked lists
- **Performance optimization**: Parallel hook execution
- **Skip patterns**: Allow specific paths to skip certain checks

## Links

- [Repository](https://github.com/3leaps/string-metrics-wasm)
- [v0.3.0 Release Notes](./v0.3.0.md) - Previous release
- [npm Package](https://www.npmjs.com/package/string-metrics-wasm)

---

**Development Infrastructure** ✅ - License compliance and type safety automated
