# Release Notes: v0.3.0

**Status:** Ready for Release **Release Date:** 2025-10-30

## Overview

v0.3.0 expands string-metrics-wasm with token-based fuzzy matching, process helpers, and a unified
API. This release completes Phase 1 of the rapidfuzz-rs migration, adding 13 new functions while
maintaining performance and keeping bundle size well below target.

## What's New

### Token-Based Fuzzy Matching (TypeScript)

Advanced fuzzy comparison functions that handle word order and substrings:

- **`partialRatio(a, b)`** - Best matching substring using sliding window
- **`tokenSortRatio(a, b)`** - Order-insensitive token comparison
- **`tokenSetRatio(a, b)`** - Set-based token comparison with duplicate handling

All return 0-100 scale scores for intuitive similarity assessment.

```typescript
tokenSortRatio('new york mets', 'mets york new'); // 100.0
partialRatio('fuzzy', 'fuzzy wuzzy was a bear'); // 100.0
```

### Process Helpers (TypeScript)

Find best matches from arrays with configurable scoring:

- **`extractOne(query, choices, options)`** - Find single best match
- **`extract(query, choices, options)`** - Find top N matches

Both support custom scorers, preprocessors, score cutoffs, and limits. Compatible with RapidFuzz
semantics (`>=` cutoff comparison).

```typescript
const choices = ['Atlanta Falcons', 'New York Jets', 'Dallas Cowboys'];
extractOne('jets', choices, { score_cutoff: 30 });
// { choice: 'New York Jets', score: 35.29, index: 1 }
```

### Unified API (TypeScript)

Metric-selectable interface with consistent scales:

- **`distance(a, b, metric?)`** - Edit distance (raw integer, lower = more similar)
- **`score(a, b, metric?)`** - Similarity score (0-1 normalized, higher = more similar)

Supports all 16 available metrics with automatic scale normalization.

```typescript
distance('hello', 'world'); // 4 (default: levenshtein)
score('hello', 'world', 'jaro_winkler'); // 0.4666...
score('new york mets', 'mets york new', 'token_sort_ratio'); // 1.0
```

### Extended WASM Metrics (rapidfuzz-rs)

Six new WASM-backed functions from rapidfuzz-rs:

- **`ratio(a, b)`** - Fuzzy matching using Indel distance (0-100 scale)
- **`indel_distance(a, b)` / `indel_normalized_similarity(a, b)`** - Insertion/deletion only
- **`lcs_seq_distance(a, b)` / `lcs_seq_similarity(a, b)` /
  `lcs_seq_normalized_similarity(a, b)`** - Longest Common Subsequence

## Bug Fixes

- **ratio() scale bug** - Now correctly returns 0-100 (was returning 0-1)
- **extractOne() cutoff** - Changed from `>` to `>=` for RapidFuzz parity
- **tokenSetRatio() edge case** - Fixed bug returning 100 for completely different token sets with
  empty intersection

## Performance

All string operations complete in **< 1ms**:

- **WASM metrics**: 0.0003-0.0005ms per operation
- **Token-based metrics**: 0.0003-0.0017ms per operation
- **Process helpers**: 0.0008-0.001ms per operation
- **Unified API**: minimal dispatch overhead

Run `node benchmark-phase1b.js` for detailed benchmarks.

## Bundle Size

- **Current**: 226 KB (30 KB packaged after excluding dev tools)
- **Previous (v0.2.0)**: 225 KB
- **Change**: +1 KB (+0.4%)
- **Target**: ≤275 KB ✅

Bundle growth is negligible despite adding 13 new functions.

## Test Coverage

- **115 unit tests** (up from 47, +68 new tests)
- **80 YAML fixture test cases** across 5 new fixture files
- **100% regression-free** - All tests passing
- **All quality checks passing** - rustfmt, clippy, biome, prettier

## Breaking Changes

None. This is a feature-addition release with full backward compatibility.

## Migration from v0.2.0

No code changes required. Simply upgrade:

```bash
npm install string-metrics-wasm@0.3.0
```

All v0.2.0 functions continue to work unchanged.

## Documentation

- **[README.md](../../README.md)** - Complete API documentation with examples
- **[Suggestions API Guide](../user-guide/suggestions-api.md)** - Extended with new metrics
- **[Development Guide](../development.md)** - Updated references to rapidfuzz-rs
- **[CHANGELOG.md](../../CHANGELOG.md)** - Full change history

## Implementation Strategy

This release follows a **hybrid WASM + TypeScript approach**:

- **WASM** for core distance metrics (maximum performance)
- **TypeScript** for token-based operations (array operations, avoids serialization overhead)
- **TypeScript** for process helpers and unified API (flexibility, extensibility)

This pattern maximizes performance while maintaining developer experience and bundle efficiency.

## Credits

- Built with [wasm-bindgen](https://github.com/rustwasm/wasm-bindgen)
- Metrics from [rapidfuzz-rs](https://github.com/rapidfuzz/rapidfuzz-rs) 0.5.0
- Inspired by Python [rapidfuzz](https://github.com/maxbachmann/RapidFuzz)
- Test fixtures compatible with [Crucible](https://github.com/fulmenhq/crucible) schema v2.0.0

## Links

- [Repository](https://github.com/3leaps/string-metrics-wasm)
- [npm Package](https://www.npmjs.com/package/string-metrics-wasm)
- [v0.2.0 Release Notes](./v0.2.0.md) - RapidFuzz migration
- [v0.1.0 Release Notes](./v0.1.0.md) - Initial release

---

**Phase 1 Complete** ✅ - All planned features delivered, bundle size under target, 100% test
coverage
