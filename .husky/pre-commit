#!/bin/sh

# string-metrics-wasm Pre-commit Hook
# Fast formatting and quality checks

echo "ğŸ”§ string-metrics-wasm Pre-commit Checks..."

# 1. Code formatting (auto-fix)
echo "ğŸ“ Formatting code..."
make format || {
  echo "âŒ Formatting failed. Please fix before committing."
  exit 1
}

# 2. Format check (verify)
echo "ğŸ” Verifying format..."
make format-check || {
  echo "âŒ Format check failed. Please fix before committing."
  exit 1
}

# 3. Linting
echo "ğŸ§¹ Linting..."
make lint || {
  echo "âŒ Linting errors found. Please fix before committing."
  exit 1
}

# 4. Type checking
echo "ğŸ” Type checking..."
make typecheck || {
  echo "âŒ TypeScript type errors found. Please fix before committing."
  exit 1
}

# 5. Rust checks
echo "ğŸ¦€ Checking Rust code..."
make rust-fmt || {
  echo "âŒ Rust formatting failed. Please fix before committing."
  exit 1
}

make rust-clippy || {
  echo "âŒ Clippy errors found. Please fix before committing."
  exit 1
}

echo "âœ… All pre-commit checks passed!"
